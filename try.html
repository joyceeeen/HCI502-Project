<!DOCTYPE html>
<meta charset="utf-8">
<style type="text/css">
table {
  font-family: "Helvetica", "Lucida Sans", "Lucida Sans Unicode", "Luxi Sans", Tahoma, sans-serif;
  box-shadow: 1px 1px 10px rgba(0,0,0,0.5);
  border-collapse: collapse;
  border-spacing: 0;
}
table {
  margin: auto;
}
table, td, th {
  padding: 7px;
  text-align: center;
  border: 1px solid rgb(8,48,107);
}
th {
  background-color: rgb(8,81,156);
  color: white;
}
</style>
<body>
<script src="http://d3js.org/d3.v3.js"></script>â€‹
<script>
jdata = [
  {"type":"FeatureCollection","metadata":{"generated":1468237141000,"url":"http://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_hour.geojson","title":"USGS All Earthquakes, Past Hour","status":200,"api":"1.5.2","count":5},"features":[{"type":"Feature","properties":{"mag":4.4,"place":"260km ENE of Dili, East Timor","time":1468235224670,"updated":1468236275574,"tz":540,"url":"http://earthquake.usgs.gov/earthquakes/eventpage/us100062l6","detail":"http://earthquake.usgs.gov/earthquakes/feed/v1.0/detail/us100062l6.geojson","felt":0,"cdi":1,"mmi":null,"alert":null,"status":"reviewed","tsunami":0,"sig":298,"net":"us","code":"100062l6","ids":",us100062l6,","sources":",us,","types":",cap,dyfi,geoserve,nearby-cities,origin,phase-data,tectonic-summary,","nst":null,"dmin":4.009,"rms":1,"gap":71,"magType":"mb","type":"earthquake","title":"M 4.4 - 260km ENE of Dili, East Timor"},"geometry":{"type":"Point","coordinates":[127.8075,-7.7862,127.54]},"id":"us100062l6"},
{"type":"Feature","properties":{"mag":2.02,"place":"2km E of Valencia, CA","time":1468234969750,"updated":1468235593051,"tz":-420,"url":"http://earthquake.usgs.gov/earthquakes/eventpage/ci37412239","detail":"http://earthquake.usgs.gov/earthquakes/feed/v1.0/detail/ci37412239.geojson","felt":0,"cdi":0,"mmi":null,"alert":null,"status":"automatic","tsunami":0,"sig":63,"net":"ci","code":"37412239","ids":",ci37412239,","sources":",ci,","types":",dyfi,general-link,geoserve,nearby-cities,origin,phase-data,scitech-link,","nst":7,"dmin":0.09085,"rms":0.3,"gap":156,"magType":"ml","type":"earthquake","title":"M 2.0 - 2km E of Valencia, CA"},"geometry":{"type":"Point","coordinates":[-118.5538333,34.4516667,0.69]},"id":"ci37412239"},
{"type":"Feature","properties":{"mag":1.5,"place":"58km WSW of Glennallen, Alaska","time":1468234631000,"updated":1468235433861,"tz":-480,"url":"http://earthquake.usgs.gov/earthquakes/eventpage/ak13749942","detail":"http://earthquake.usgs.gov/earthquakes/feed/v1.0/detail/ak13749942.geojson","felt":null,"cdi":null,"mmi":null,"alert":null,"status":"automatic","tsunami":0,"sig":35,"net":"ak","code":"13749942","ids":",ak13749942,","sources":",ak,","types":",general-link,geoserve,nearby-cities,origin,tectonic-summary,","nst":null,"dmin":null,"rms":0.93,"gap":null,"magType":"ml","type":"earthquake","title":"M 1.5 - 58km WSW of Glennallen, Alaska"},"geometry":{"type":"Point","coordinates":[-146.6302,61.9858,110.1]},"id":"ak13749942"},
{"type":"Feature","properties":{"mag":2.2,"place":"80km ESE of Old Iliamna, Alaska","time":1468234216000,"updated":1468235433281,"tz":-480,"url":"http://earthquake.usgs.gov/earthquakes/eventpage/ak13749936","detail":"http://earthquake.usgs.gov/earthquakes/feed/v1.0/detail/ak13749936.geojson","felt":null,"cdi":null,"mmi":null,"alert":null,"status":"automatic","tsunami":0,"sig":74,"net":"ak","code":"13749936","ids":",ak13749936,","sources":",ak,","types":",general-link,geoserve,nearby-cities,origin,tectonic-summary,","nst":null,"dmin":null,"rms":0.63,"gap":null,"magType":"ml","type":"earthquake","title":"M 2.2 - 80km ESE of Old Iliamna, Alaska"},"geometry":{"type":"Point","coordinates":[-153.6102,59.4536,98.1]},"id":"ak13749936"},
{"type":"Feature","properties":{"mag":1.82,"place":"7km SW of Tamalpais-Homestead Valley, California","time":1468233899200,"updated":1468236722783,"tz":-420,"url":"http://earthquake.usgs.gov/earthquakes/eventpage/nc72660331","detail":"http://earthquake.usgs.gov/earthquakes/feed/v1.0/detail/nc72660331.geojson","felt":null,"cdi":null,"mmi":null,"alert":null,"status":"automatic","tsunami":0,"sig":51,"net":"nc","code":"72660331","ids":",nc72660331,","sources":",nc,","types":",general-link,geoserve,nearby-cities,origin,phase-data,scitech-link,tectonic-summary,","nst":23,"dmin":0.04057,"rms":0.05,"gap":159,"magType":"md","type":"earthquake","title":"M 1.8 - 7km SW of Tamalpais-Homestead Valley, California"},"geometry":{"type":"Point","coordinates":[-122.5866699,37.8240013,5.28]},"id":"nc72660331"}],"bbox":[-153.6102,-7.7862,0.69,127.8075,61.9858,127.54]}
];


d3.select("body").selectAll("table")
    .data([jdata])
  .enter().append("table")
    .call(recurse);

function recurse(sel) {
  // sel is a d3.selection of one or more empty tables
  sel.each(function(d) {
    // d is an array of objects
    var colnames,
        tds,
        table = d3.select(this);

    // obtain column names by gathering unique key names in all 1st level objects
    // following method emulates a set by using the keys of a d3.map()
    colnames = d                                                          // array of objects
        .reduce(function(p,c) { return p.concat(d3.keys(c)); }, [])       // array with all keynames
        .reduce(function(p,c) { return (p.set(c,0), p); }, d3.map())      // map with unique keynames as keys
        .keys();                                                          // array with unique keynames (arb. order)

    // colnames array is in arbitrary order
    // sort colnames here if required

    // create header row using standard 1D data join and enter()
    table.append("thead").append("tr").selectAll("th")
        .data(colnames)
      .enter().append("th")
        .text(function(d) { return d; });

    // create the table cells by using nested 2D data join and enter()
    // see also http://bost.ocks.org/mike/nest/
    tds = table.append("tbody").selectAll("tr")
        .data(d)                            // each row gets one object
      .enter().append("tr").selectAll("td")
        .data(function(d) {                 // each cell gets one value
          return colnames.map(function(k) { // for each colname (i.e. key) find the corresponding value
            return d[k] || "";              // use empty string if key doesn't exist for that object
          });
        })
      .enter().append("td");

    // cell contents depends on the data bound to the cell
    // fill with text if data is not an Array
    tds.filter(function(d) { return !(d instanceof Array); })
        .text(function(d) { return d; });
    // fill with a new table if data is an Array
    tds.filter(function(d) { return (d instanceof Array); })
        .append("table")
        .call(recurse);
  });
}
</script>
